2025-07-16 21:32:45,604 - INFO - Sample train set 1500/67349
2025-07-16 21:32:45,604 - INFO - ... including dev set 500 samples
2025-07-16 21:32:45,605 - INFO - Loading model with FP16...
10
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.93it/s]
2025-07-16 21:32:51,448 - WARNING - Some parameters are on the meta device device because they were offloaded to the disk.
2025-07-16 21:32:51,450 - INFO - Done with 5.85s
2025-07-16 21:32:51,659 - INFO - Dev samples: 500
2025-07-16 21:32:51,660 - INFO - Train samples: 1000
2025-07-16 21:32:51,660 - INFO - Eval sample length is 872
2025-07-16 21:32:51,660 - INFO - Tokenizing training samples...
2025-07-16 21:32:52,513 - INFO - Done with 0.85s
2025-07-16 21:32:52,515 - WARNING - You shouldn't move a model when it is dispatched on multiple devices.
Traceback (most recent call last):
  File "/home/rinya/zero-order-optimization/src/run.py", line 740, in <module>
    main()
  File "/home/rinya/zero-order-optimization/src/run.py", line 692, in main
    framework.train(train_samples, dev_samples if dev_samples is not None else eval_samples, eval_samples)
  File "/home/rinya/zero-order-optimization/src/run.py", line 543, in train
    trainer = OurTrainer(model=self.model,
  File "/home/rinya/zero-order-optimization/src/trainer.py", line 143, in __init__
    super().__init__(*args, **kwargs)  # Initialize the base class
  File "/home/rinya/anaconda3/envs/zollm2/lib/python3.10/site-packages/transformers/trainer.py", line 498, in __init__
    self._move_model_to_device(model, args.device)
  File "/home/rinya/anaconda3/envs/zollm2/lib/python3.10/site-packages/transformers/trainer.py", line 740, in _move_model_to_device
    model = model.to(device)
  File "/home/rinya/anaconda3/envs/zollm2/lib/python3.10/site-packages/accelerate/big_modeling.py", line 425, in wrapper
    raise RuntimeError("You can't move a model that has some modules offloaded to cpu or disk.")
RuntimeError: You can't move a model that has some modules offloaded to cpu or disk.